- [Работа с файлами](#работа-с-файлами)
  - [Создание нового файла](#создание-нового-файла)
  - [Чтение из файла](#чтение-из-файла)
    - [Terminal](#terminal)
  - [Запись файла](#запись-файла)
    - [Terminal](#terminal-1)
  - [Дозапись в файл](#дозапись-в-файл)
    - [Terminal](#terminal-2)
  - [Переименование файла](#переименование-файла)
  - [Удаление файла](#удаление-файла)

# Работа с файлами

Для работы с файлами применяется встроенный модуль `fs`:

```javascript
const fs = require("express")
```
**Функции, которые заканчиваются на `Sync` являются синхронными.**
***

## Создание нового файла

```javascript
fs.open("hello.txt", "w", (err) => {
    if (err) throw err
    console.log("Файл создан")
})
```

`fs.open` принимает два параметра: 

   1. название файла и его расширение;
   2. флаг, указывающий системе на то, что именно нужно сделать с этим файлом:

       * `r` - открыть файл для чтения;
       * `r+` - открыть файл для чтения и записи;
       * `rs` - открыть файл для чтения в синхронном режиме;
       * `w` - открыть файл для записи;
       * `a` - открыть файл для записи данных в конец файла;
       * `a+` - открыть файл для чтения и записи данных в конец файла.
***
## Чтение из файла


Для синхронного чтения файла применяется функция `fs.readFileSync()`, которая принимает два параметра: `"название.файла", "формат"`:

```javascript
let fileContent = fs.readFileSync("hello.txt", "utf8")
```

Для асинхронного чтения файла применяется функция `fs.readFile`:

```javascript
let fileContent = fs.readFile("hello.txt", "utf8", function (error, data) { })
```

Есть три параметра:

* 1 и 2 параметр - `название.файла` и `формат`;
* 3 параметр - функция обратного вызова, которая выполняется после завершения чтения файла.

Пример чтения файла из `app.js`:

```javascript
// Асинхронный вариант
fs.readFile("hello.txt", "utf8",
    function (error, data) {
        console.log("Асинхронное чтение файла")
        
        if (error) throw error
        console.log(data)
})


// Синхронный вариант
console.log("Синхронное чтение файла")
let fileContent = fs.readFileSync("hello.txt", "utf8")
console.log(fileContent)
```

### Terminal
```bash
Синхронное чтение файла
Hello, Kravich

Асинхронное чтение файла
Hello, Kravich
```

Хоть функция `fs.readFile()` вызывается первой, но, поскольку она является асинхронной - она не блокирует поток выполнения и её результат выводится после синхронного кода.
***

## Запись файла

Запись в синхронном варианте с помощью функции `fs.writeFileSync()`, которая в качестве двух параметров принимает `имя.файла` и `записываемые данные`:

```javascript
fs.writeFileSync("hello.txt", "\nПривет, Кравич")
```

Запись в асинхронном варианте с помощью функции `fs.writeFile()`, которая принимает те же параметры:

```javascript
fs.writeFile("hello.txt", "\nПривет Кравичам")
```

**Обе эти функции перезаписывают передаваемый файл.**

В качестве спомогательного параметра в функцию может передаваться функция обратного вызова, которая выполняется после завершения записи:

```javascript
fs.writeFile("hello.txt", "Привет, Кравич", function (error) {

    if (error) throw error 
    console.log("Асинхронная запись завершена. Содержимое файла:")

    let data = fs.readFileSync("hello.txt", "utf8")
    console.log(data)
})
```
### Terminal

```
Асинхронная запись завершена. Содержимое файла:
Привет, Кравич
```
***
## Дозапись в файл
Для дозаписи в конец файла используются методы `fs.appendFile()` и `fs.appendFileSync()`:

```javascript
fs.appendFile("hello.txt", "\nКу", function (error) {

    if (error) throw error

    console.log("Запись файла завершена, содержимое файла:")

    let data = fs.readFileSync("hello.txt", "utf8")
    console.log(data) // Вывод считанных данных
})


// Синхронная дозапись
fs.appendFileSync("hello.txt", "\nVladislav")
```

### Terminal

```
Запись файла завершена, содержимое файла:
Привет, Кравич
Vladislav
Ку
```

Та же история с асинхронной функцией: стоит она до синхронной, а исполняется после.

**Для дозаписи в начало файла используется метод `fs.write()`.**
***

## Переименование файла

Для переименования файлов используется метод `fs.rename()`:

```javascript
fs.rename("hello.txt", "kravich.txt", (err) => {
    if (err) throw err
    console.log("Файл переименован")
})
```
***

## Удаление файла

Для синхронного удаления файла используется `fs.unlinkSync()`:

```javascript
fs.unlinkSync("hello.txt")
```

Для асинхронного удаления файла используется `fs.unlink()` с двумя параметрами `файл.удаления` и `функция после завершения удаления`:

```javascript
fs.unlink("hello.txt", (err) => {
    if (err) console.log(err)
    else console.log("File hello.txt was deleted")
})
```
